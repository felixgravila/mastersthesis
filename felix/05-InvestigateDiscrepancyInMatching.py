#!/usr/bin/env python
# coding: utf-8

# In[ ]:


import pandas as pd
from matplotlib import pyplot as plt
import h5py
import numpy as np


# In[ ]:


mappedref = "CGACATCGAGGTGCCAAACACCGCCGTCGATATGAACTCTTGGGCGGTATCAGCCTGTTATCCCCGGAGTACCTTTTATCCGTTGAGCGATGGCCCTTCCATTCAGAACCACCGGATCACTATGACCTGCTTTCGCACCTGCTCGCGCCGTCACGCTCGCAGTCAAGCTGGCTTATGCCATTGCACTAACCTCCTGATGTCCGACCAGGATTAGCCAACCTTCGTGCTCCTCCGTTACTCTTTAGGAGGAGACCGCCCCAGTCAAACTACCCACCAGACACTGTCCGCAACCCGGATTACGGGTCAACGTTAGAACATCAAACATTAAAGGGTGGTATTTCAAGGTCGGCTCCATGCAGACTGGCGTCCACACTTCAAAGCCTCCCACCTATCCTACACATCAAGGCTCAATGTTCAGTGTCAAGCTATAGTAAAGGTTCACGGGGTCTTTCCGTCTTGCCGCGGGTACACTGCATCTTCACAGCGAGTTCAATTTCACTGAGTCTCGGGTGGAGACAGCCTGGCCATCATTACGCCATTCGTGCAGGTCGGAACTTACCCGACAAGGAATTTCGCTACCTTAGGACCGTTATAGTTACGGCCGCCGTTTACCGGGGCTTCGATCAAGAGCTTCGCCTTGCGGCTAACCCCATCAATTAACCTTCCGGCACCGGGCAGGCGTCACACCGTATACGTCCACTTTCGTGTTTGCACAGTGCTGTGTTTTTAATAAACAGTTGCAGCCAGCTGGTATCTTCGACTGATTTCAGCTCCATCCGCGAGGGACTTCACCTACATATCAGCGTGCCTTCTCCCGAAGTTACGGCACCATTTTGCCTAGTTCCTTCACCCGAGTTCTCTCAAGCGCCTTGGTATTCTCTACCTGACCACCTGTGTCGGTTTGGGGTACGATTTGATGTTACCTGATGCTTAGAGGCTTTTCCTGGAAGCAGGGCATTTGTTGCTTCAGCACCGTAGTGCCTCGTCATCACGCCTCAGCCTTGATTTTCCGGATTTGCCTGGAAAACCAGCCTACACGCTTAAACCGGGACAACCGTCGCCCGGCCAACATAGCCTTCTCCGTCCCCCCTTCGCAGTAACACCAAGTACAGGAATATTAACCTGTTTCCCATCGACTACGCCTTTCGGCCTCGCCTTAGGGGTCGACTCACCCTGCCCCGATTAACGTTGGACAGGAACCCTTGGTCTTCCGGCGAGCGGGCTTTTCACCCGCTTTATCGTTACTTATGTCAGCATTCGCACTTCTGATACCTCCAGCATACCTCACAGTACACCTTCACAGGCTTACAGAACGCTCCCCTACCCAACAACACATAGTGTCGCTGCCGCAGCTTCGGTGCATGGTTTAGCCCCGTTACATCTTCCGCGCAGGCCGACTCGACCAGTGAGCTATTACGCTTTCTTTAAATGATGGCTGCTTCTAAGCCAACATCCTGGCTGTCTGGGCCTTCCCACATCGTTTCCCACTTAACCATGACTTTGGGACCTTAGCTGGCGGTCTGGGTTGTTTCCCTCTTCACGACGGACGTTAGCACCCGCCGTGTGTCTCCCGTGATAACATTCTCCGGTATTCGCAGTTTGCATCGGGTTGGTAAGTCGGGATGACCCCCTTGCCGAAACAGTGCTCTACCCCCGGAGATGAATTCACGAGGCGCTACCTAAATAGCTTTCGGGGAGAACCAGCTATCTCCCGGTTTGATTGGCCTTTCACCCCCAACCACAAGTCATCCGCTAATTTTTCAACATTAGTCGGTTCGGTCCTCCAGTTAGTGTTACCCAACCTTCAACCTGCCCATGGCTAGATCACCGGGTTTCGGGTCTATACCCTGCAACTTAACGCCCAGTTAAGACTCGGTTTCCCTTCGGCTCCCCTATTCGGTTAACCTTGCTACAGAATATAAGTCGCTGACCCATTATACAAAAGGTACGCAGTCACACGCCTAAGCGTGCTCCCACTGCTTGTACGTACACGGTTTCAGGTTCTTTTTCACTCCCCTCGCCGGGGTTCTTTTCGCCTTTCCCTCACGGTACTGGTTCACTATCGGTCAGTCAGGAGTATTTAGCCTTGGAGGATGGTCCCCCCATATTCAGACAGGATACCACGTGTCCCGCCCTACTCATCGAGCTCACAGCATGTGCATTTTTGTGTACGGGGCTGTCACCCTGTATCGCACGCCTTTCCAGACGCTTCCACTAACACACACACTGATTCAGGCTCTGGGCTGCTCCCCGTTCGCTCGCCGCTACTGGGGGAATCTCGGTTGATTTCTTTTCCTCGGGGTACTTAGATGTTTCAGTTCCCCCGGTTCGCCTCATTAACCTATGGATTCAGTTAATGATAGTGTGTCGAAACACACTGGGTTTCCCCATTCGGAAATCGCCGGTTATAACGGTTCATATCACCTTACCGACGCTTATCGCAGATTAGCACGTCCTTCATCGCCTCTGACTGCCAGGGCATCCACCGTGTACGCTTAGTCGCTTAACCTCACAACCCGAAGATGTTTCTTTCGATTCATCATCGTGTTGCGAAAATTTGAGAGACTCACGAACAACTTTCGTTGTTCAGTGTTTCAATTTTCAGCTTGATCCAGATTTTTAAAGAGCAAAACTTCGCAGTGAACCTTTGCAGGTACACTCTGAAGTATTTTTTATTTAATCACTACAGAGATGGTGGAGCTATGCGGGATCGAACCGCAGACCTCCTGCGTGCAAAGCAGGCGCTCTCCCAGCTGAGCTATAGCCCCATAACATGTAGTTAAAACCTCTTCAAATTTGCCGTGCAAATTTGGTAGGCCTGAGTGGACTTGAACCACCGACCTCACCCTTATCAGGGGTGCGCTCTAACCACCTGAGCTACAAGCCTGTAGAGGTTTTACTGCTCATTTTCATCAGACAATCTGTGTGAGCACTTCAAAGAACGCTTCTTTAAGGTAAGGAGGTGATCCAACCGCAGGTTCCCCTACGGTTACCTTGTTACGACTTCACCCCAGTCATGAATCACAAAGTGGTAAGCGCCCTCCCGAAGGTTAAGCTACCTACTTCTTTTGCAACCCACTCCCATGGTGTGACGGGCGGTGTGTACAAGGCCCGGGAACGTATTCACCGTGGCATTCTGATCCACGATTACTAGCGATTCCGACTTCATGGAGTCGAGTTGCAGACTCCAATCCGGACTACGACGCACTTTATGAGGTCCGCTTGCTCTCGCGAGGTCGCTTCTCTTTGTATGCGCCATTGTAGCACGTGTGTAGCCCTGGTCGTAAGGGCCATGATGACTTGACGTCATCCCCACCTTCCTCCAGTTTATCACTGGCAGTCTCCTTTGAGTTCCCGGCCGGACCGCTGGCAACAAAGGATAAGGGTTGCGCTCGTTGCGGGACTTAACCCAACATTTCACAACACGAGCTGACGACAGCCATGCAGCACCTGTCTCACAGTTCCCGAAGGCACCAATCCATCTCTGGAAAGTTCTGTGGATGTCAAGACCAGGTAAGGTTCTTCGCGTTGCATCGAATTAAACCACATGCTCCACCGCTTGTGCGGGCCCCCGTCAATTCATTTGAGTTTTAACCTTGCGGCCGTACTCCCCAGGCGGTCGACTTAACGCGTTAGCTCCGGAAGCCACGCCTCAAGGGCACAACCTCCAAGTCGACATCGTTTACGGCGTGGACTACCAGGGTATCTAATCCTGTTTGCTCCCCACGCTTTCGCACCTGAGCGTCAGTCTTCGTCCAGGGGGCCGCCTTCGCCACCGGTATTCCTCCAGATCTCTACGCATTTCACCGCTACACCTGGAATTCTACCCCCCTCTACGAGACTCAAGCTTGCCAGTATCAGATGCAGTTCCCAGGTTGAGCCCGGGGATTTCACATCTGACTTAACAAACCGCCTGCGTGCGCTTTACGCCCAGTAATTCCGATTAACGCTTGCACCCTCCGTATTACCGCGGCTGCTGGCACGGAGTTAGCCGGTGCTTCTTCTGCGGGTAACGTCAATGAGCAAAGGTATTAACTTTACTCCCTTCCTCCCCGCTGAAAGTACTTTACAACCCGAAGGCCTTCTTCATACACGCGGCATGGCTGCATCAGGCTTGCGCCCATTGTGCAATATTCCCCACTGCTGCCTCCCGTAGGAGTCTGGACCGTGTCTCAGTTCCAGTGTGGCTGGTCATCCTCTCAGACCAGCTAGGGATCGTCGCCTAGGTGAGCCGTTACCCCACCTACTAGCTAATCCCATCTGGGCACATCCGATGGCAAGAGGCCCGAAGGTCCCCCTCTTTGGTCTTGCGACGTTATGCGGTATTAGCTACCGTTTCCAGTAGTTATCCCCCTCCATCAGGCAGTTTCCCAGACATTACTCACCCGTCCGCCACTCGTCAGCAAAGAAGCAAGCTTCTTCCTGTTACCGTTCGACTTGCATGTGTTAGGCCTGCCGCCAGCGTTCAATCTGAGCCATGATCAAACTCT"
reffrombioguys = "GTTGTGCTTCGTTCCGGTTACGTATTGCTAATGATACGGCGGCGACCACCGAGATCTACTAGCATGTGCTAGGACGACATCGAGGTGCCAAACACCGCCGTCGATATGAACTCTTAGGCGGTATCGGCCTATTATCAGGTACCTTTATCGTTAGAGCGATGGCCGCCATTTCAGAGCCACCGGATCACTATGGCTGCTTTCGCACCTGCTCGCGCCGTCACGCTCTGTCAAGCTGGCTTATGCCATTGCACTAACCTCTGATGTCCGACCAGGATTGTAACCTTCGTGCTCCTCCGTTACTCTTTAGGAGGGAGACCTTTGATCAAACTACCCACCAGACACTGTCCGCAGCGGATTACGGGTCAACGTTAGAACATCAAACATTAAAGGGTGGTATTTCAAAGGTCGGCTCCATGCGGGCTGGCGTCCCTACTTCAAAGCCTCCACCTATCCTACACATCAAGGCTCCATGTTCAGTGTCAAATATAGTAAGGTTCAGGTCTTTCCGTCTTGCCGCGGGTACACTGCATCTTCGCAGCGAGTTCAATTTCACTGAGTCTCAGGTGGAGACATGCCAGCCATCATTACGCCATTCGTGCAGGTCGGAACTTACCCGACAAGAATTTCGCTACCTTAGGACCGTTATAGTTACGGCCGCCGTTTACCGAGGCTTCGATCAAAGCTTCGCCTTGCGGCTAACCCCATCATTAACCTTCAAGCACCGGGCGGCGATCACACACCATGTACGTCCCACTTTCGTGTTTGCACAGTGCTGTGTTTTTAATAAACAGTTGCAGCCAGCTGGTATCTTCGACTGATTTCAAACCATGCGAGGACTTCACCTACATATCCGGTGTATTCTCCCGAAGTTACGGCACCATTTTGCCCTAGTTCAACTGCCAGGGTTATATAAGCGCCTTGGTATTCTCTGCCTGACACCTGTGTCGGTTTGGGGGCGCGATTTGTGTTACCTGAGTGCTTAGAGGCTTTTCCTGGAAGCAGGGCATTTGTTGCTTCGGCACCGTAGTGCCTCGTCATCACGCCTCAGCCTTGACTCCGGATTTGCACGAAGCCAGCCTACACGCTTAAACCAGGCAACCGTCGCCCGGCCAACGCATCAGCCTTCTCCGTCCCCCTTCGCGGTAACACCAAGTACAGGAATAACCTGTTTCCCATCATTCGCCTTTCGGCCTCGCCTTAGGGGTCGGCTGCTACCGGTAACGATTGGACAGGAACCCTTGATTCTTCCGGCGAGCGGGCTACCACTTTATCGTTACTTGTATTCAGCATTCGCACTTCTGATACCTCCAGCATGCCTCACAGTACACCTTCACAGCGGGCTTACAGAACGCTCCCTGCACAACAACACATAGTGTCAGCTGCCGCGGCTTCGGTGCATGGTTTATTGCGTACATCTTCCGCGCAGGCCGACTCGACCGACATTATTCATTACGCTTTCTTTAATGATAACTTCTAGCCAACATCCGCAACATCCAGGCTTCCCACATCGTTTCCCACTTAACCATGACTTTGGGACGCCAAGCTGGCAGGTCTGCGGTTCTTTCCTCTGCGACGGACGTTAGCACCGCCGTGTGTCTCCGTGATAACATTCTCCGGTATTCACAGTTTGCATCAGGTTGGTAAGTCAGGATGACCCCCCTTGCCGAAACAGTGCTCTACCCCCGGAGATGGTCACGAGGCGCTACCTAAATAGCTTTCGGGGAGAACCAGCTATCTCCCGGTTTGATTGGCCTTTCACCCCCAACCACAAGTCATCGCTAATTTTTCAACATTGATCGGTTCGGTCCTCCAGTTAGTGTTACCCAACCTTCAACCTACTTATGGCTGATCACCGGGTTTCGGGTCTATACCCCTGCAACTTAACGCCCAGTTAAGACTCGGACTTCCCTTCAGCTCCCCCTATTCGGTTAACGCTGCAGAATATAAGTCGCTGACCCATTATACAAAGGTACGCAGTCACACGCCTAGCGTGCTCCCACTCTTGCTTTTGGTTTCAGGTTCTTTTCACTCCCTCGCGGGGTTCTTTTCGCCTTTCCTGCAGGTACTGGTTTGCTATCGGTCAGTCAAATTATTTAGCCTTGGAGGATGGTCCCCCATATTCAGACAGGATACCACGTGTCCGCCCCTACTCATCGACTCTGGCGTATTATCGGTGTTTTTGTGTTACTGGTTTTTGTCACCCTGTATCGCACGCGCCCTCCAGACAGCCACTAACACACACACTGGTTCAGGCTCTGGGCTGCTCGTTGCTCCTCGCCGCTACTGGGGAATCTCAGTTGATTTCTTTTCCTCAGGGTGCCGATGTTTCAGTTTCCCCCAGTTCGCCCCTCATTAACCTATGGATTCGGTGTGATGGTGTGTCGAAACACACTGGGTTTCCCCATTCGGAAATCGCCGGTTATAACGGTTCATATCACCTTACCGACGCTTATCGCAGATTAGCGTCCTTCATCGCCTCTGACTGCCAGGGCATCCACCGTGTACGCTTAGTCGCTTAACCTCACAACCCGAAGATGTTACCGTTCATCATCGTGTTGAAAATTTGAAGACTCACGAACAACTTTCGTTGTTCAGTGTTTCCAATTTTCAGCAGTCAGTTTTTAAGAGCAAAACTTCGCAGTAATTTGCGGGTGCTCTGAAGTATTTTTATTTAATCACTACGAAGGATGGTGGGCTATGGGATCAGACCGCAGACCTCCTGCGTGCAAGCAGGCGCTCTCCCAGCTGAGCTATGGCCCCCATAACATGTAGTTAAAACCTCTTCAAATTTGCCGTGCAAATTTGGTAGGCCCTGATGGACTTGAACCACCGACCTCACCCACATATCAGAGAGTTTGCTCTAGTACCTGAGCTACAAGCCTGAAAGTTTACTGCTCATTTTCATCAGACCAATCTGTGTAGGCAGCACTTCAAGAACGCTTCTTTAAGGTAAGGAGGTGATCAACCGCAGGTTCCCCTACGATTACCTTGTTACGACTTCACCCCAGTCATGAATCCACAAAGTGGTAGCTTCCCTCCGAAGGGTTAAGCTACCTACTTCTTTTGCAACCCCTCCCATGGTGTGACGGGCGGGTGTGTACAAGGCCGGGAACGTATTCACCGTGGCATTCTGATCCACGATTATAGCGATTCCGACTTCATGGAGTCGAGTTGCAGACTCCAATCGGACTACGACGCACTTTATGAGGTCCGCTTGCTCTCGCGAGGTCGCTTCTCTTTGTATGCGCCATTGCCTTGGCACGTGTGTAGCCCTGGTCGTAGAGGCCATGATGACTTGACGTCATCCCCACCTTCCTCCAGTTTATCACTGGCAGTCTCCTTTGAGTTCCCAGCCGGACCGCTGGCAACAAAGGATAAGGGGATTTGCGCGCTCGTTGCAGGACTTAACCCAACATTTCACAACACGAGCTGACGACAGCCATGCAGCACCTGTCTCACAGTTCCCGAAGGCACCAATCCATCTCTGGAAAGTTCTGTGGATGTCAAGACCAGGTAAGGTTCTTCGCGTTGCATCGAATTAAACCACATGCTCCACCGCTTGTGCAGGCCCCGTCAATTCATTGAGTTTTAACCTTGCAGCCCGTACTCCCAGGCGGTCGACTTAACGCGTTAGCTCGGAAGCCACGCCTCAAGGGCACAACCTCAAGTCGACATCGTTTACGGCGTGGACTACCAGGGTATAATCCTGTTGCTCCCCACGCTTTCGCACCTGAGCGTCAGTCTTCGTCAGGGGGCCGCCTTCGCCACCGGTATTCCTCAGATCTCTCGCATTTCACCGCTTTACACCTGGAATTCTACCCCCTCTACGAGACTCAAGCACCCGAGTATCAGATGCAGTTTGGGTTGAGCGAAGTTTCACATCTGACTTAACAAACCGCCGCCGTGCGCTTCCCGCCCGGTAATTCCGATTAACGCTTGCACCTCGAAATGATACCGCGGCTGCTGGCACGGAGTTAGCCGGTGCTTCTTCTGCAGGTAACGTCAACGAGCAAGGTAGTAACTTTTCCACTCCTTCGCACCTCCCCGCTGAAAAGTACTTTACAACCAGTGCTTCTTCATACACGCGGCATGAAAACGCATCAGGCTTTACGCCCATTGTGCAATATTCCCCACTGCCGCCTCCGCTAGGAGTCTGGACCGTGTCTCAGTTCCAGTGTGGCTGGTCATCCTCTCAGACCAGCTAGGGATCGTCGCCTAGGTGAGCCGTTACCCCACCTACTAGCTAATCCCATCTGGGCACATCCGATGGCAAGAGGCCAGAGGTCCCCCTCTTTGGTCTTGCGACGTTATGCGGTATTAGCTACCGTTTCCAGTAGTTATCCCCCTCCATCAGGCAGTTTCCAGACATTACTCACCCGTCCGCCACTCGTCAGCAAAGAAACGAAACTTCTTCCTGTTACCATTAAACTTGCATGTGTTAGGCCTGCCGCCAGCGTTCAATCTGAGCCATGATCAAACTCTCTCCACCATGTAGTACCAATCTCGTATGCCGTCTTCTGCTTGAAGGCAATGCGTAAC"


# In[ ]:


# from taiyaki encoding
labelBaseMap = {
    0: "A",
    1: "C",
    2: "G",
    3: "T"
}

def get_reads_dict(filename):
    file = h5py.File(filename, "r")
    file = file['Reads']
    reads = []
    for r in file.keys():
        elem = {}
        elem['UUID'] = r
        for k in file[r].keys():
            elem[k]=file[r][k][()]
        reads.append(elem)
    return reads
  
reads = get_reads_dict("../taiyakiOutputs/output_createfasta.hdf5")
print(reads[0]['UUID'])
ref = reads[0]['Reference']
ref = list(map(lambda x: labelBaseMap[x], ref))
ref = "".join(ref)

# len ref == len mappedref

print(reffrombioguys)
print(mappedref)

print(len(reffrombioguys))
print(len(mappedref))


# In[ ]:


i=1
while len(reffrombioguys.split(mappedref[:i])) > 1:
    i+=1
print(i-1)


# In[ ]:


print(len(reffrombioguys.split(mappedref[:41])[0]))
print(mappedref[:30])


# In[ ]:




